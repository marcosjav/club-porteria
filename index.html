    <!DOCTYPE HTML>
    <html>
        <head>
        <title>Simple Live Display</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script type="text/javascript">
            var ws;
            var wsUri = "ws:";
            var loc = window.location;
            console.log(loc);
            if (loc.protocol === "https:") { wsUri = "wss:"; }
            // This needs to point to the web socket in the Node-RED flow
            // ... in this case it's ws/simple
            wsUri += "//" + loc.host + loc.pathname.replace("simple","ws/simple");

            function wsConnect() {
                console.log("connect",wsUri);
                ws = new WebSocket(wsUri);
                //var line = "";    // either uncomment this for a building list of messages
                ws.onmessage = function(msg) {
                    console.log(msg);
                    let json;
                    try {
                        json = JSON.parse(msg.data);
                        console.log(json);
                    } catch (error) {
                        console.log("ERROR - JsonParse");
                    }
                    if (json){
                        $('#tbody').prepend(addClient(json));
                    }
                }
                ws.onopen = function() {
                    // update the status div with the connection status
                    document.getElementById('status').innerHTML = "connected";
                    //ws.send("Open for data");
                    console.log("connected");
                }
                ws.onclose = function() {
                    // update the status div with the connection status
                    document.getElementById('status').innerHTML = "not connected";
                    // in case of lost connection tries to reconnect every 3 secs
                    setTimeout(wsConnect,3000);
                }
            }
            
            function doit(m) {
                if (ws) { ws.send(m); }
            }

            function addClient(client){
                let d = new Date(client.time);
                let l = new Date(client.last);
                let l_d = l.getDate();
                let l_m = l.getMonth() + 1;
                let l_y = l.getFullYear();

                let u = new Date(client.until);
                let u_d = u.getDate();
                let u_m = u.getMonth() + 1;
                let u_y = u.getFullYear();

                let row = "";
                row += '<tr><th scope="row">';
                row += d.getHours() + ":" + (d.getMinutes()<10?('0'+d.getMinutes()):d.getMinutes());
                row += '</th><td style="background-image:';
                row += client.photo ? client.photo : "url('img/nophoto.jpg')";
                row += ';" class="profile-picture"></td><td>';
                row += client.name;
                row += '</td><td>';
                row += client.number;
                row += '</td><td>';
                row += client.dni;
                row += '</td><td>';
                row += (l_d<10?'0':'') + l_d +'/'+ (l_m<10?'0':'') + l_m +'/'+l_y;
                row += '</td><td>';
                row += (u_d<10?'0':'') + u_d +'/'+ (u_m<10?'0':'') + u_m +'/'+u_y;
                row += '</td><td class="text-success">';
                if(client.category === "Activo")
                    row += '    <i class="fas fa-check fa-2x text-success"></i>';
                else
                    row += '    <i class="fas fa-times-circle fa-2x text-danger"></i>';

                row += '</td></tr>';

                return row;
            }
        </script>
        </head>
        <body onload="wsConnect();" onunload="ws.disconnect();">
            <font face="Arial">
            <h1>Simple Live Display</h1>
            <div id="messages"></div>
            <button type="button" onclick='doit("click");'>Click to send message</button>
            <hr/>
            <div id="status">unknown</div>
            </font>
            <table class="table table-hover table-striped">
            <thead>
                <th></th>
                <th></th>
                <th>Nombre</th>
                <th>NÃºmero</th>
                <th>DNI</th>
                <th>Ult. Pago</th>
                <th>Hasta</th>
                <th></th>
            </thead>
                <tbody id="tbody"></tbody>
            </table>
        </body>
    </html>
